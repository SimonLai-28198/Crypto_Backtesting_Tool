//@version=6
strategy("SmaCross Strategy - é›™å‡ç·šäº¤å‰ç­–ç•¥", 
         overlay=true, 
         initial_capital=10000,
         default_qty_type=strategy.percent_of_equity,
         default_qty_value=100,
         commission_type=strategy.commission.percent,
         commission_value=0.1)

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ç­–ç•¥åç¨±ï¼šé›™å‡ç·šäº¤å‰ç­–ç•¥ (Simple Moving Average Crossover)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// 
// ã€ç­–ç•¥åŸç†ã€‘
// åˆ©ç”¨çŸ­æœŸå‡ç·šå’Œé•·æœŸå‡ç·šçš„äº¤å‰ä¾†åˆ¤æ–·è¶¨å‹¢è®ŠåŒ–ï¼š
// - çŸ­æœŸå‡ç·šåæ‡‰å¿«ï¼Œèƒ½åŠæ™‚æ•æ‰åƒ¹æ ¼è®ŠåŒ–
// - é•·æœŸå‡ç·šåæ‡‰æ…¢ï¼Œä»£è¡¨æ•´é«”è¶¨å‹¢æ–¹å‘
// - ç•¶çŸ­æœŸå‡ç·šç©¿è¶Šé•·æœŸå‡ç·šæ™‚ï¼Œä»£è¡¨è¶¨å‹¢å¯èƒ½åè½‰
// 
// ã€è²·å…¥è¨Šè™Ÿã€‘é»ƒé‡‘äº¤å‰ (Golden Cross)
// - æ¢ä»¶ï¼šçŸ­æœŸå‡ç·šç”±ä¸‹å¾€ä¸Šç©¿è¶Šé•·æœŸå‡ç·š
// - æ„ç¾©ï¼šçŸ­æœŸåƒ¹æ ¼é–‹å§‹å¼·æ–¼é•·æœŸè¶¨å‹¢ï¼Œå¯èƒ½é€²å…¥ä¸Šæ¼²è¶¨å‹¢
// - å‹•ä½œï¼šå…¨å€‰è²·å…¥
// 
// ã€è³£å‡ºè¨Šè™Ÿã€‘æ­»äº¡äº¤å‰ (Death Cross)
// - æ¢ä»¶ï¼šçŸ­æœŸå‡ç·šç”±ä¸Šå¾€ä¸‹è·Œç ´é•·æœŸå‡ç·š
// - æ„ç¾©ï¼šçŸ­æœŸåƒ¹æ ¼é–‹å§‹å¼±æ–¼é•·æœŸè¶¨å‹¢ï¼Œå¯èƒ½é€²å…¥ä¸‹è·Œè¶¨å‹¢
// - å‹•ä½œï¼šå¹³å€‰æ‰€æœ‰æŒå€‰
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// ========== ç­–ç•¥åƒæ•¸è¨­å®š ==========
// é€™äº›åƒæ•¸å¯ä»¥åœ¨ TradingView çš„ç­–ç•¥è¨­å®šä¸­èª¿æ•´
n1 = input.int(10, "çŸ­æœŸå‡ç·šé€±æœŸ (SMA Short)", minval=1, maxval=200, 
               tooltip="çŸ­æœŸç§»å‹•å¹³å‡ç·šçš„è¨ˆç®—é€±æœŸï¼Œé è¨­ç‚º 10 æ ¹ K æ£’")
n2 = input.int(50, "é•·æœŸå‡ç·šé€±æœŸ (SMA Long)", minval=1, maxval=500, 
               tooltip="é•·æœŸç§»å‹•å¹³å‡ç·šçš„è¨ˆç®—é€±æœŸï¼Œé è¨­ç‚º 50 æ ¹ K æ£’")

// ========== è¨ˆç®—æŠ€è¡“æŒ‡æ¨™ ==========
// è¨ˆç®—çŸ­æœŸç°¡å–®ç§»å‹•å¹³å‡ç·š (SMA)
// ta.sma(source, length) è¨ˆç®—æŒ‡å®šé€±æœŸçš„ç°¡å–®ç§»å‹•å¹³å‡
sma_short = ta.sma(close, n1)

// è¨ˆç®—é•·æœŸç°¡å–®ç§»å‹•å¹³å‡ç·š (SMA)
sma_long = ta.sma(close, n2)

// ========== ç¹ªè£½æŒ‡æ¨™åˆ°åœ–è¡¨ ==========
// åœ¨ä¸»åœ–ä¸Šç¹ªè£½çŸ­æœŸå‡ç·šï¼ˆè—è‰²ï¼‰
plot(sma_short, title="SMA Short", color=color.blue, linewidth=2)

// åœ¨ä¸»åœ–ä¸Šç¹ªè£½é•·æœŸå‡ç·šï¼ˆæ©˜è‰²ï¼‰
plot(sma_long, title="SMA Long", color=color.orange, linewidth=2)

// ========== äº¤æ˜“è¨Šè™Ÿæª¢æ¸¬ ==========
// ta.crossover(source1, source2) æª¢æ¸¬ source1 æ˜¯å¦ç”±ä¸‹å¾€ä¸Šç©¿è¶Š source2
// é»ƒé‡‘äº¤å‰ï¼šçŸ­æœŸå‡ç·šå‘ä¸Šç©¿è¶Šé•·æœŸå‡ç·š
golden_cross = ta.crossover(sma_short, sma_long)

// æ­»äº¡äº¤å‰ï¼šçŸ­æœŸå‡ç·šå‘ä¸‹è·Œç ´é•·æœŸå‡ç·šï¼ˆç­‰åŒæ–¼é•·æœŸå‡ç·šå‘ä¸Šç©¿è¶ŠçŸ­æœŸå‡ç·šï¼‰
death_cross = ta.crossover(sma_long, sma_short)

// ========== åŸ·è¡Œäº¤æ˜“é‚è¼¯ ==========
// â˜… é»ƒé‡‘äº¤å‰ â†’ è²·å…¥è¨Šè™Ÿ â˜…
if golden_cross
    // strategy.entry() é–‹å€‰å‡½æ•¸
    // åƒæ•¸ï¼š("è¨‚å–®ID", æ–¹å‘)
    // strategy.long è¡¨ç¤ºåšå¤šï¼ˆè²·å…¥ï¼‰
    strategy.entry("Long", strategy.long, 
                   comment="ğŸŸ¢ é»ƒé‡‘äº¤å‰è²·å…¥")

// â˜… æ­»äº¡äº¤å‰ â†’ è³£å‡ºè¨Šè™Ÿ â˜…
if death_cross
    // strategy.close() å¹³å€‰å‡½æ•¸
    // é—œé–‰æŒ‡å®š ID çš„æ‰€æœ‰æŒå€‰
    strategy.close("Long", 
                   comment="ğŸ”´ æ­»äº¡äº¤å‰è³£å‡º")

// ========== è¦–è¦ºåŒ–äº¤æ˜“è¨Šè™Ÿ ==========
// åœ¨åœ–è¡¨ä¸Šæ¨™è¨˜é»ƒé‡‘äº¤å‰é»ï¼ˆç¶ è‰²å‘ä¸Šä¸‰è§’å½¢ï¼‰
plotshape(golden_cross, 
          title="é»ƒé‡‘äº¤å‰", 
          location=location.belowbar, 
          color=color.new(color.green, 0), 
          style=shape.triangleup, 
          size=size.small,
          text="è²·å…¥")

// åœ¨åœ–è¡¨ä¸Šæ¨™è¨˜æ­»äº¡äº¤å‰é»ï¼ˆç´…è‰²å‘ä¸‹ä¸‰è§’å½¢ï¼‰
plotshape(death_cross, 
          title="æ­»äº¡äº¤å‰", 
          location=location.abovebar, 
          color=color.new(color.red, 0), 
          style=shape.triangledown, 
          size=size.small,
          text="è³£å‡º")

// ========== èƒŒæ™¯é¡è‰²æç¤º ==========
// ç•¶æŒæœ‰å¤šé ­å€‰ä½æ™‚ï¼ŒèƒŒæ™¯é¡¯ç¤ºæ·¡ç¶ è‰²
// strategy.position_size > 0 è¡¨ç¤ºæœ‰å¤šé ­æŒå€‰
bgcolor(strategy.position_size > 0 ? color.new(color.green, 90) : na, 
        title="æŒå€‰èƒŒæ™¯")

// ========== è­¦å ±æ¢ä»¶è¨­å®š ==========
// å¯ä»¥åœ¨ TradingView ä¸­åŸºæ–¼é€™äº›æ¢ä»¶è¨­å®šè­¦å ±
alertcondition(golden_cross, 
               title="é»ƒé‡‘äº¤å‰è­¦å ±", 
               message="SmaCross ç­–ç•¥ï¼šæª¢æ¸¬åˆ°é»ƒé‡‘äº¤å‰ï¼Œå»ºè­°è²·å…¥ï¼")

alertcondition(death_cross, 
               title="æ­»äº¡äº¤å‰è­¦å ±", 
               message="SmaCross ç­–ç•¥ï¼šæª¢æ¸¬åˆ°æ­»äº¡äº¤å‰ï¼Œå»ºè­°è³£å‡ºï¼")
